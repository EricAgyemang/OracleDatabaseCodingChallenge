SQL> SHOW PAGESIZE;
pagesize 20
SQL> SET PAGESIZE 20;
SQL> 
SQL> 
SQL> SET ECHO ON;
SQL> -- AGYEMANG ERIC
SQL> -- IT 478 ADVANCED DATABASE PROCESSING
SQL> -- EXAM 1
SQL> 
SQL> -- Q3.Show first name, last name, city, state and whole years of service (no decimal places) for all employees--Order by last name ascending. Use only explicit joins.
SQL> SELECT first_name,last_name,city, state, ROUND((SYSDATE-start_date)/365) AS "Whole Years of Service" 
  2  FROM employees e 
  3      JOIN addresses a ON e.employee_id = a.employee_id
  4  ORDER BY last_name;

FIRST_NAME                LAST_NAME                                          CITY                      ST Whole Years of Service
------------------------- -------------------------------------------------- ------------------------- -- ----------------------
James                     Anders                                             Edwardsville              KS                     26
Mary                      Biers                                              Overland Park             KS                     22
Sandra                    Cain                                               Tulsa                     OK                     12
Matthew                   Cavil                                              Lees Summit               MO                     16
Ken                       Conoy                                              Gardner                   KS                     18
Daniel                    Cottle                                             Independence              MO                     23
Donald                    Doral                                              Kansas City               MO                     13
Linda                     Dualla                                             Mission                   KS                     17
Cynthia                   Foster                                             Waldo                     MO                     13
Sue                       Graystone                                          Edwardsville              MO                     20
Helen                     Katriaine                                          Lenexa                    KS                     17
George                    Lampkin                                            Grandview                 MO                     19
Carol                     Roslin                                             Leawood                   KS                     21
Lauren                    Thrace                                             Piper                     KS                     14
Kevin                     Tigh                                               Martin City               MO                     20
Gary                      Tyrol                                              Des Moines                IA                     18

16 rows selected. 

SQL> 
SQL> 
SQL> -- Q5. List the 3 youngest employees first name, last name, branch_name and division_name. Show first name, last name and whole years of age (no decimal places). (Show only three employees) Order by age descending. Use only implicit joins.
SQL> SELECT *
  2  FROM (SELECT e.first_name,e.last_name,b.branch_name,d.division_name,ROUND((SYSDATE-dob)/365) AS "AGE"
  3  FROM employees e,addresses a,branches b,divisions d
  4  WHERE e.employee_id=a.employee_id AND
  5  e.branch_id=b.branch_id AND b.division_id=d.division_id
  6  ORDER BY AGE
  7  FETCH FIRST 3 ROWS ONLY)
  8  ORDER BY AGE DESC;

FIRST_NAME                LAST_NAME                                          BRANCH_NAME                                        DIVISION_NAME                                                                                               AGE
------------------------- -------------------------------------------------- -------------------------------------------------- ---------------------------------------------------------------------------------------------------- ----------
Helen                     Katriaine                                          Solicitor                                          Legal                                                                                                        26
Kevin                     Tigh                                               Retail                                             Sales                                                                                                        25
Donald                    Doral                                              Development                                        Information Technology                                                                                       23

SQL> 
SQL> 
SQL> 
SQL> -- Q6. List the 3 youngest employees first name, last name, branch_name and division_name. Show first name, last name and whole years of age (no decimal places). (Show only three employees) Order by age descending. Use only explicit joins.
SQL> SELECT* 
  2  FROM (SELECT e.first_name,e.last_name,b.branch_name,d.division_name,ROUND((SYSDATE-dob)/365) AS "AGE"
  3  FROM addresses a JOIN employees e ON a.employee_id=e.employee_id 
  4       JOIN branches b ON e.branch_id=b.branch_id 
  5            JOIN divisions d ON b.division_id=d.division_id
  6  ORDER BY AGE
  7  FETCH FIRST 3 ROWS ONLY)
  8  ORDER BY AGE DESC;

FIRST_NAME                LAST_NAME                                          BRANCH_NAME                                        DIVISION_NAME                                                                                               AGE
------------------------- -------------------------------------------------- -------------------------------------------------- ---------------------------------------------------------------------------------------------------- ----------
Helen                     Katriaine                                          Solicitor                                          Legal                                                                                                        26
Kevin                     Tigh                                               Retail                                             Sales                                                                                                        25
Donald                    Doral                                              Development                                        Information Technology                                                                                       23

SQL> 
SQL> 
SQL> -- Q7. Show the first name, last name, branch_name and division_name and the age at hire of the 3 employees who were the oldest when they were hired (Show only three employees) Use only implicit joins.
SQL> SELECT* 
  2  FROM (SELECT e.first_name,e.last_name,b.branch_name,d.division_name,ROUND((start_date-dob)/365) AS "AGE_AT_HIRE"
  3  FROM employees e,addresses a,branches b,divisions d
  4  WHERE e.employee_id=a.employee_id AND
  5  e.branch_id=b.branch_id AND b.division_id=d.division_id
  6  ORDER BY AGE_AT_HIRE DESC)
  7  FETCH FIRST 3 ROWS ONLY;

FIRST_NAME                LAST_NAME                                          BRANCH_NAME                                        DIVISION_NAME                                                                                        AGE_AT_HIRE
------------------------- -------------------------------------------------- -------------------------------------------------- ---------------------------------------------------------------------------------------------------- -----------
Lauren                    Thrace                                             Manager                                            Operations                                                                                                    26
Cynthia                   Foster                                             Database Administration                            Information Technology                                                                                        23
Sue                       Graystone                                          Recruitment                                        Human Resources                                                                                               19

SQL> 
SQL> -- Q8. Show the first name, last name, branch_name and division_name and the age at hire of the 3 employees who were the oldest when they were hired (Show only three employees) Use only explicit joins.
SQL> SELECT* 
  2  FROM (SELECT e.first_name,e.last_name,b.branch_name,d.division_name,ROUND((start_date-dob)/365) AS "AGE_AT_HIRE"
  3        FROM employees e 
  4           JOIN addresses a ON e.employee_id=a.employee_id 
  5               JOIN branches b ON e.branch_id=b.branch_id 
  6                    JOIN divisions d ON  b.division_id=d.division_id
  7  ORDER BY AGE_AT_HIRE DESC)
  8  FETCH FIRST 3 ROWS ONLY;

FIRST_NAME                LAST_NAME                                          BRANCH_NAME                                        DIVISION_NAME                                                                                        AGE_AT_HIRE
------------------------- -------------------------------------------------- -------------------------------------------------- ---------------------------------------------------------------------------------------------------- -----------
Lauren                    Thrace                                             Manager                                            Operations                                                                                                    26
Cynthia                   Foster                                             Database Administration                            Information Technology                                                                                        23
Sue                       Graystone                                          Recruitment                                        Human Resources                                                                                               19

SQL> 
SQL> 
SQL> -- Q11. Show first name, last name, and date_awarded for all winners of the “Employee of the year” award. Use only natural joins.
SQL> SELECT first_name,last_name,date_awarded
  2  FROM employees NATURAL JOIN awards NATURAL JOIN employee_awards
  3  WHERE award_desc='Employee of the year';

FIRST_NAME                LAST_NAME                                          DATE_AWAR
------------------------- -------------------------------------------------- ---------
James                     Anders                                             12-NOV-18

SQL> 
SQL> 
SQL> 
SQL> -- Q12. Show first name, last name, and date_awarded for all winners of the “Employee of the year” award. Use only implicit joins.
SQL> SELECT e.first_name,e.last_name,enp.date_awarded
  2  FROM employees e,employee_awards enp, awards a
  3  WHERE e.employee_id=enp.employee_id AND 
  4  enp.award_id=a.award_id AND
  5  a.award_desc='Employee of the year';

FIRST_NAME                LAST_NAME                                          DATE_AWAR
------------------------- -------------------------------------------------- ---------
James                     Anders                                             12-NOV-18

SQL> 
SQL> -- Q14. Show first name and last name for all winners of BOTH the “Employee of the year” and "Best new employee" awards. Use only natural joins.
SQL> SELECT first_name,last_name
  2  FROM employees NATURAL JOIN awards NATURAL JOIN employee_awards 
  3  WHERE award_desc = 'Employee of the year'
  4  
  5  INTERSECT
  6  
  7  SELECT first_name,last_name
  8  FROM employees NATURAL JOIN awards NATURAL JOIN employee_awards 
  9  WHERE award_desc = 'Best new employee';
no rows selected
SQL> 
SQL> 
SQL> -- Q15. Show first name, last name and award_desc for all winners of either the “Employee of the year” or "Best new employee" awards. Use IN
SQL> SELECT e.first_name,e.last_name, award_desc
  2  FROM employees e,employee_awards enp, awards a
  3  WHERE e.employee_id=enp.employee_id AND 
  4  enp.award_id=a.award_id AND award_desc IN ('Employee of the year', 'Best new employee');

FIRST_NAME                LAST_NAME
------------------------- --------------------------------------------------
AWARD_DESC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
James                     Anders                                             
Employee of the year                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

Lauren                    Thrace                                             
Best new employee                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           


SQL> 
SQL> 
SQL> --Q16. Show first name, last name and award_desc for all winners of either the “Employee of the year” or "Best new employee" awards. Use only natural joins.
SQL> SELECT first_name, last_name, award_desc
  2  FROM employees NATURAL JOIN awards NATURAL JOIN employee_awards 
  3  WHERE award_desc IN ('Employee of the year', 'Best new employee');

FIRST_NAME                LAST_NAME
------------------------- --------------------------------------------------
AWARD_DESC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
James                     Anders                                             
Employee of the year                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

Lauren                    Thrace                                             
Best new employee                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           


SQL> 
SQL> 
SQL> -- Q17. Show first name, last name and award_desc for all winners of either the “Employee of the year” or "Best new employee" awards. Use UNION.
SQL> SELECT first_name,last_name, award_desc
  2  FROM employees NATURAL JOIN awards NATURAL JOIN employee_awards 
  3  WHERE award_desc = 'Employee of the year'
  4  
  5  UNION
  6  
  7  SELECT first_name,last_name, award_desc
  8  FROM employees NATURAL JOIN awards NATURAL JOIN employee_awards 
  9  WHERE award_desc = 'Best new employee';

FIRST_NAME                LAST_NAME
------------------------- --------------------------------------------------
AWARD_DESC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
James                     Anders                                             
Employee of the year                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

Lauren                    Thrace                                             
Best new employee                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           


SQL> 
SQL> 
SQL> --Q18. Show all employees last name, blog_desc and blog_url. If the employee does not have a blog, show "No Blog" in the blog_desc column and "NA" in the blog_url column.
SQL> SELECT last_name, NVL((blog_desc), 'No Blog') AS blog_desc, NVL((blog_url), 'NA') AS blog_url
  2  FROM
  3  (SELECT e.last_name, b.blog_desc, b.blog_url
  4  FROM employees e 
  5       LEFT JOIN websites w ON e.employee_id=w.employee_id 
  6          LEFT JOIN blogs b ON w.blog_id=b.blog_id);

LAST_NAME
--------------------------------------------------
BLOG_DESC
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
BLOG_URL                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Anders                                             
Jims new blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
http://www.linkedup.com/blog/janders                                                                                                                                                                                                                      

Biers                                              
Desktop rollout blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
http://www.linkedup.com/blog/mbiers                                                                                                                                                                                                                       

Tyrol                                              
Garyblog!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
http://www.linkedup.com/blog/gtyrol                                                                                                                                                                                                                       

Tigh                                               

LAST_NAME
--------------------------------------------------
BLOG_DESC
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
BLOG_URL                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Winter sales blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
http://www.linkedup.com/blog/sgraystone                                                                                                                                                                                                                   

Cavil                                              
Matts neat blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
http://www.linkedup.com/blog/mcavil                                                                                                                                                                                                                       

Katriaine                                          
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        

Cain                                               
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     

LAST_NAME
--------------------------------------------------
BLOG_DESC
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
BLOG_URL                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
NA                                                                                                                                                                                                                                                        

Graystone                                          
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        

Cottle                                             
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        

Conoy                                              
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        

LAST_NAME
--------------------------------------------------
BLOG_DESC
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
BLOG_URL                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Roslin                                             
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        

Lampkin                                            
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        

Dualla                                             
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        


LAST_NAME
--------------------------------------------------
BLOG_DESC
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
BLOG_URL                                                                                                                                                                                                                                                  
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Thrace                                             
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        

Foster                                             
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        

Doral                                              
No Blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
NA                                                                                                                                                                                                                                                        


16 rows selected. 

SQL> 
SQL> 
SQL> -- Q19. Show all employees last name, branch_name and division_name. If the employee does not have a branch_name or division_name, those columns should be blank.
SQL> SELECT last_name, NVL((branch_name), ' ') AS branch_name, NVL((division_name), ' ') AS division_name
  2  FROM
  3  (SELECT e.last_name, b.branch_name, d.division_name
  4  FROM employees e 
  5       LEFT JOIN branches b ON b.branch_id=e.branch_id 
  6          LEFT JOIN divisions d ON b.division_id=d.division_id);

LAST_NAME                                          BRANCH_NAME                                        DIVISION_NAME                                                                                       
-------------------------------------------------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------
Cavil                                              Database Administration                            Information Technology                                                                              
Tyrol                                              Database Administration                            Information Technology                                                                              
Foster                                             Database Administration                            Information Technology                                                                              
Biers                                              System Administration                              Information Technology                                                                              
Cottle                                             System Administration                              Information Technology                                                                              
Roslin                                             System Administration                              Information Technology                                                                              
Dualla                                             Development                                        Information Technology                                                                              
Doral                                              Development                                        Information Technology                                                                              
Conoy                                              Accounts Receivable                                Finance                                                                                             
Anders                                             Training                                           Human Resources                                                                                     
Graystone                                          Recruitment                                        Human Resources                                                                                     
Tigh                                               Retail                                             Sales                                                                                               
Katriaine                                          Solicitor                                          Legal                                                                                               
Cain                                               Secretarial                                        Operations                                                                                          
Lampkin                                            Manager                                            Operations                                                                                          
Thrace                                             Manager                                            Operations                                                                                          

16 rows selected. 

SQL> 
SQL> 
SQL> -- Q20. show all employees' first name and last name and the first name and last name of their project manager. If the employee does not have a project manager, the first name and last name of their project manager should be blank.
SQL> SELECT e.first_name, e.last_name, e.employee_id, NVL((pmgr.first_name), ' ') AS project_manager_first_name, NVL((pmgr.last_name), ' ') AS project_manager_last_name
  2  FROM employees e 
  3       LEFT JOIN projects p USING (project_id) LEFT JOIN 
  4       (SELECT first_name, last_name, employee_id FROM employees e JOIN projects p USING(project_id) 
  5       WHERE  e.employee_id=p.project_mgr_id) pmgr
  6       ON p.project_mgr_id = pmgr.employee_id;

FIRST_NAME                LAST_NAME                                          EMPLOYEE_ID PROJECT_MANAGER_FIRST_NAM PROJECT_MANAGER_LAST_NAME                         
------------------------- -------------------------------------------------- ----------- ------------------------- --------------------------------------------------
James                     Anders                                                       1 James                     Anders                                            
Mary                      Biers                                                        2 Mary                      Biers                                             
Daniel                    Cottle                                                       4 Mary                      Biers                                             
Carol                     Roslin                                                      10 Mary                      Biers                                             
Linda                     Dualla                                                       3 Linda                     Dualla                                            
Matthew                   Cavil                                                        5 Linda                     Dualla                                            
Donald                    Doral                                                        8 Linda                     Dualla                                            
Gary                      Tyrol                                                       11 Gary                      Tyrol                                             
Cynthia                   Foster                                                      12 Gary                      Tyrol                                             
Lauren                    Thrace                                                      16 Gary                      Tyrol                                             
Kevin                     Tigh                                                        14 Kevin                     Tigh                                              
George                    Lampkin                                                     15 Kevin                     Tigh                                              
Helen                     Katriaine                                                    6                                                                             
Ken                       Conoy                                                        7                                                                             
Sue                       Graystone                                                    9                                                                             
Sandra                    Cain                                                        13                                                                             

16 rows selected. 

SQL> 
SQL> -- Q22. Do a full outer join on the employees, emails and messages tables. Use on.
SQL> SELECT *
  2  FROM employees
  3     FULL OUTER JOIN emails ON employees.employee_id=emails.employee_id
  4           FULL OUTER JOIN messages ON emails.employee_id = messages.employee_id;

EMPLOYEE_ID FIRST_NAME                M LAST_NAME                                          G DOB       START_DAT  BRANCH_ID PROJECT_ID SIGNUP_DA LAST_LOGI LOGIN_COUNT   EMAIL_ID EMAIL_ADDRESS                                      EMPLOYEE_ID MESSAGE_ID
----------- ------------------------- - -------------------------------------------------- - --------- --------- ---------- ---------- --------- --------- ----------- ---------- -------------------------------------------------- ----------- ----------
MESSAGE_TEXT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MESSAGE_D EMPLOYEE_ID
--------- -----------
          1 James                     J Anders                                             M 01-JAN-80 14-NOV-95          6          2 01-JAN-20 14-JAN-21        2135          2 janders@gmail.com                                            1          1 
Call me soon.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
01-JAN-20           1

          1 James                     J Anders                                             M 01-JAN-80 14-NOV-95          6          2 01-JAN-20 14-JAN-21        2135          1 janders@linkedup.com                                         1          1 
Call me soon.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
01-JAN-20           1

          1 James                     J Anders                                             M 01-JAN-80 14-NOV-95          6          2 01-JAN-20 14-JAN-21        2135          2 janders@gmail.com                                            1          2 
How about breakfast?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
10-JAN-20           1

          1 James                     J Anders                                             M 01-JAN-80 14-NOV-95          6          2 01-JAN-20 14-JAN-21        2135          1 janders@linkedup.com                                         1          2 

EMPLOYEE_ID FIRST_NAME                M LAST_NAME                                          G DOB       START_DAT  BRANCH_ID PROJECT_ID SIGNUP_DA LAST_LOGI LOGIN_COUNT   EMAIL_ID EMAIL_ADDRESS                                      EMPLOYEE_ID MESSAGE_ID
----------- ------------------------- - -------------------------------------------------- - --------- --------- ---------- ---------- --------- --------- ----------- ---------- -------------------------------------------------- ----------- ----------
MESSAGE_TEXT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MESSAGE_D EMPLOYEE_ID
--------- -----------
How about breakfast?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
10-JAN-20           1

          3 Linda                     F Dualla                                             F 24-OCT-90 25-MAY-04          1          3 01-APR-20 31-DEC-20        1245          4 ldualla@linkedup.com                                         3          3 
I left the project documents on your desk.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
11-JAN-20           3

          4 Daniel                    D Cottle                                             M 23-NOV-89 07-AUG-98          2          1 23-FEB-20 06-JUN-20        1220          5 dcottle@linkedup.com                                         4          4 
The boss wants you to call her.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
04-FEB-20           4

          6 Helen                     B Katriaine                                          F 13-JUL-95 22-JUN-04         10            25-JAN-20 12-JAN-21         915          8 hkatriaine@linkedup.com                                      6          5 
Your appointment with Gary is today.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

EMPLOYEE_ID FIRST_NAME                M LAST_NAME                                          G DOB       START_DAT  BRANCH_ID PROJECT_ID SIGNUP_DA LAST_LOGI LOGIN_COUNT   EMAIL_ID EMAIL_ADDRESS                                      EMPLOYEE_ID MESSAGE_ID
----------- ------------------------- - -------------------------------------------------- - --------- --------- ---------- ---------- --------- --------- ----------- ---------- -------------------------------------------------- ----------- ----------
MESSAGE_TEXT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MESSAGE_D EMPLOYEE_ID
--------- -----------
11-FEB-20           6

         11 Gary                      E Tyrol                                              M 01-NOV-85 12-FEB-04          3          5 06-AUG-20 31-DEC-20        1495         16 gtyrol@linkedup.com                                         11          6 
Wheres my coffee mug?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
28-FEB-20          11

         12 Cynthia                   L Foster                                             F 21-OCT-85 12-DEC-08          3          5 03-JAN-20 31-DEC-20        1478         17 cfoster@linkedup.com                                        12          7 
linkedup is so cool!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
07-MAR-20          12

         14 Kevin                     P Tigh                                               M 01-JUL-96 06-APR-02          8          4 09-MAR-20 14-OCT-20         996         20 ktigh@gmail.com                                             14          8 
I need you to come in early Monday.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
08-MAR-20          14

EMPLOYEE_ID FIRST_NAME                M LAST_NAME                                          G DOB       START_DAT  BRANCH_ID PROJECT_ID SIGNUP_DA LAST_LOGI LOGIN_COUNT   EMAIL_ID EMAIL_ADDRESS                                      EMPLOYEE_ID MESSAGE_ID
----------- ------------------------- - -------------------------------------------------- - --------- --------- ---------- ---------- --------- --------- ----------- ---------- -------------------------------------------------- ----------- ----------
MESSAGE_TEXT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MESSAGE_D EMPLOYEE_ID
--------- -----------

         14 Kevin                     P Tigh                                               M 01-JUL-96 06-APR-02          8          4 09-MAR-20 14-OCT-20         996         19 ktigh@linkedup.com                                          14          8 
I need you to come in early Monday.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
08-MAR-20          14

         16 Lauren                    K Thrace                                             F 26-OCT-81 14-FEB-08         12          5 07-NOV-20 12-JAN-21        1221         22 lthrace@linkedup.com                                        16          9 
So say we all.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
09-JUN-20          16

          5 Matthew                   S Cavil                                              M 14-APR-91 24-JUN-05          3          3 24-JUN-20 06-APR-20        1145          7 mcavil@hotmail.com                                           5            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     


EMPLOYEE_ID FIRST_NAME                M LAST_NAME                                          G DOB       START_DAT  BRANCH_ID PROJECT_ID SIGNUP_DA LAST_LOGI LOGIN_COUNT   EMAIL_ID EMAIL_ADDRESS                                      EMPLOYEE_ID MESSAGE_ID
----------- ------------------------- - -------------------------------------------------- - --------- --------- ---------- ---------- --------- --------- ----------- ---------- -------------------------------------------------- ----------- ----------
MESSAGE_TEXT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MESSAGE_D EMPLOYEE_ID
--------- -----------
          5 Matthew                   S Cavil                                              M 14-APR-91 24-JUN-05          3          3 24-JUN-20 06-APR-20        1145          6 mcavil@linkedup.com                                          5            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     

          8 Donald                    X Doral                                              M 14-MAR-99 30-JUL-08          1          3 17-OCT-20 11-NOV-20        1025         11 ddoral@linkedup.com                                          8            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     

         15 George                    E Lampkin                                            M 24-DEC-92 03-MAR-03         12          4 06-OCT-20 28-DEC-20         798         21 glampkin@linkedup.com                                       15            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     

         10 Carol                     P Roslin                                             F 11-AUG-87 12-JAN-01          2          1 01-APR-20 22-SEP-20        1123         15 croslin@linkedup.com                                        10            

EMPLOYEE_ID FIRST_NAME                M LAST_NAME                                          G DOB       START_DAT  BRANCH_ID PROJECT_ID SIGNUP_DA LAST_LOGI LOGIN_COUNT   EMAIL_ID EMAIL_ADDRESS                                      EMPLOYEE_ID MESSAGE_ID
----------- ------------------------- - -------------------------------------------------- - --------- --------- ---------- ---------- --------- --------- ----------- ---------- -------------------------------------------------- ----------- ----------
MESSAGE_TEXT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MESSAGE_D EMPLOYEE_ID
--------- -----------
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     

          7 Ken                       F Conoy                                              M 22-FEB-88 16-SEP-03          4            10-FEB-20 31-JAN-21         866         10 kconoy@yahoo.com                                             7            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     

          7 Ken                       F Conoy                                              M 22-FEB-88 16-SEP-03          4            10-FEB-20 31-JAN-21         866          9 kconoy@linkedup.com                                          7            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     

          9 Sue                       O Graystone                                          F 15-JUN-83 22-FEB-02          5            20-SEP-20 10-OCT-20        1945         14 sgraystone@yahoo.com                                         9            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

EMPLOYEE_ID FIRST_NAME                M LAST_NAME                                          G DOB       START_DAT  BRANCH_ID PROJECT_ID SIGNUP_DA LAST_LOGI LOGIN_COUNT   EMAIL_ID EMAIL_ADDRESS                                      EMPLOYEE_ID MESSAGE_ID
----------- ------------------------- - -------------------------------------------------- - --------- --------- ---------- ---------- --------- --------- ----------- ---------- -------------------------------------------------- ----------- ----------
MESSAGE_TEXT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MESSAGE_D EMPLOYEE_ID
--------- -----------
                     

          9 Sue                       O Graystone                                          F 15-JUN-83 22-FEB-02          5            20-SEP-20 10-OCT-20        1945         13 sgraystone@gmail.com                                         9            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     

          9 Sue                       O Graystone                                          F 15-JUN-83 22-FEB-02          5            20-SEP-20 10-OCT-20        1945         12 sgraystone@linkedup.com                                      9            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     

         13 Sandra                    M Cain                                               F 10-MAY-94 04-AUG-09         13            04-MAR-20 31-OCT-20        1021         18 scain@linkedup.com                                          13            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     

EMPLOYEE_ID FIRST_NAME                M LAST_NAME                                          G DOB       START_DAT  BRANCH_ID PROJECT_ID SIGNUP_DA LAST_LOGI LOGIN_COUNT   EMAIL_ID EMAIL_ADDRESS                                      EMPLOYEE_ID MESSAGE_ID
----------- ------------------------- - -------------------------------------------------- - --------- --------- ---------- ---------- --------- --------- ----------- ---------- -------------------------------------------------- ----------- ----------
MESSAGE_TEXT
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
MESSAGE_D EMPLOYEE_ID
--------- -----------

          2 Mary                      E Biers                                              F 15-MAR-84 24-APR-99          2          1 28-JAN-20 19-JAN-21        2143          3 mbiers@linkedup.com                                          2            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                     


24 rows selected. 

SQL> 
SQL> 
SQL> 
SQL> --Q23. Show the first name, last name, website_desc and blog_desc for all employees with either a website or a blog. Use UNION ALL. Results should have only three columns: first name, last name and "Website or Blog".
SQL> SELECT first_name, last_name , website_desc AS Website_or_Blog
  2  FROM
  3  (SELECT e.first_name, e.last_name, s.website_desc
  4  FROM employees e JOIN websites s 
  5    ON e.employee_id = s.employee_id
  6  
  7  UNION ALL
  8  
  9  SELECT e.first_name, e.last_name, b.blog_desc
 10  FROM employees e JOIN websites s 
 11    ON e.employee_id = s.employee_id 
 12    JOIN blogs b ON s.blog_id=b.blog_id)
 13  ORDER BY first_name;

FIRST_NAME                LAST_NAME
------------------------- --------------------------------------------------
WEBSITE_OR_BLOG                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Cynthia                   Foster                                             
Cynthia Foster website                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      

Donald                    Doral                                              
The Don Doral site                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          

Gary                      Tyrol                                              
Garyworld!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  

Gary                      Tyrol                                              
Garyblog!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

James                     Anders                                             
Jims new site                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               


FIRST_NAME                LAST_NAME
------------------------- --------------------------------------------------
WEBSITE_OR_BLOG                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
James                     Anders                                             
Jims new blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

Kevin                     Tigh                                               
Winter sales blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           

Kevin                     Tigh                                               
Winter sales push project site                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

Lauren                    Thrace                                             
Operations Branch website                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

Mary                      Biers                                              
Desktop rollout blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        


FIRST_NAME                LAST_NAME
------------------------- --------------------------------------------------
WEBSITE_OR_BLOG                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Mary                      Biers                                              
Desktop rollout project site                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

Matthew                   Cavil                                              
Matts cool website                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          

Matthew                   Cavil                                              
Matts neat blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             


13 rows selected. 

SQL> 
SQL> -- Q26. Show first name and last name for all winners “Employee of the year” award that have not won the "Best new employee" award. Use MINUS.
SQL> SELECT first_name, last_name
  2  FROM employees NATURAL JOIN employee_awards NATURAL JOIN awards
  3  WHERE award_desc = 'Employee of the year'
  4  
  5  MINUS
  6  
  7  SELECT first_name, last_name
  8  FROM employees NATURAL JOIN employee_awards NATURAL JOIN awards
  9  WHERE award_desc = 'Best new employee';

FIRST_NAME                LAST_NAME                                         
------------------------- --------------------------------------------------
James                     Anders                                            

SQL> 
SQL> 
SQL> --Q28. List the first name, last name and email_address for all employees with either a gmail or yahoo email address. Use an implicit join.
SQL> SELECT first_name, last_name, email_address 
  2  FROM EMPLOYEES, EMAILS
  3  WHERE EMPLOYEES.employee_id = EMAILS.employee_id AND email_address LIKE '%gmail%' OR email_address LIKE '%yahoo%';

FIRST_NAME                LAST_NAME                                          EMAIL_ADDRESS                                     
------------------------- -------------------------------------------------- --------------------------------------------------
James                     Anders                                             kconoy@yahoo.com                                  
Mary                      Biers                                              kconoy@yahoo.com                                  
Linda                     Dualla                                             kconoy@yahoo.com                                  
Daniel                    Cottle                                             kconoy@yahoo.com                                  
Matthew                   Cavil                                              kconoy@yahoo.com                                  
Helen                     Katriaine                                          kconoy@yahoo.com                                  
Ken                       Conoy                                              kconoy@yahoo.com                                  
Donald                    Doral                                              kconoy@yahoo.com                                  
Sue                       Graystone                                          kconoy@yahoo.com                                  
Carol                     Roslin                                             kconoy@yahoo.com                                  
Gary                      Tyrol                                              kconoy@yahoo.com                                  
Cynthia                   Foster                                             kconoy@yahoo.com                                  
Sandra                    Cain                                               kconoy@yahoo.com                                  
Kevin                     Tigh                                               kconoy@yahoo.com                                  
George                    Lampkin                                            kconoy@yahoo.com                                  
Lauren                    Thrace                                             kconoy@yahoo.com                                  
James                     Anders                                             sgraystone@yahoo.com                              

FIRST_NAME                LAST_NAME                                          EMAIL_ADDRESS                                     
------------------------- -------------------------------------------------- --------------------------------------------------
Mary                      Biers                                              sgraystone@yahoo.com                              
Linda                     Dualla                                             sgraystone@yahoo.com                              
Daniel                    Cottle                                             sgraystone@yahoo.com                              
Matthew                   Cavil                                              sgraystone@yahoo.com                              
Helen                     Katriaine                                          sgraystone@yahoo.com                              
Ken                       Conoy                                              sgraystone@yahoo.com                              
Donald                    Doral                                              sgraystone@yahoo.com                              
Sue                       Graystone                                          sgraystone@yahoo.com                              
Carol                     Roslin                                             sgraystone@yahoo.com                              
Gary                      Tyrol                                              sgraystone@yahoo.com                              
Cynthia                   Foster                                             sgraystone@yahoo.com                              
Sandra                    Cain                                               sgraystone@yahoo.com                              
Kevin                     Tigh                                               sgraystone@yahoo.com                              
George                    Lampkin                                            sgraystone@yahoo.com                              
Lauren                    Thrace                                             sgraystone@yahoo.com                              
James                     Anders                                             janders@gmail.com                                 
Sue                       Graystone                                          sgraystone@gmail.com                              

FIRST_NAME                LAST_NAME                                          EMAIL_ADDRESS                                     
------------------------- -------------------------------------------------- --------------------------------------------------
Kevin                     Tigh                                               ktigh@gmail.com                                   

35 rows selected. 

SQL> 
SQL> 
SQL> 
SQL> --Q29. List the first name, last name, city, state and email_address of all employees that live in Kansas (KS) and have a linkedup.com email account. Use using() for all joins.
SQL> SELECT e.first_name, e.last_name, a.city, a.state, m.email_address
  2  FROM employees e JOIN addresses a USING(employee_id) JOIN emails m USING(employee_id)
  3  WHERE state = 'KS' AND email_address LIKE '%linkedup.com%';

FIRST_NAME                LAST_NAME                                          CITY                      ST EMAIL_ADDRESS                                     
------------------------- -------------------------------------------------- ------------------------- -- --------------------------------------------------
James                     Anders                                             Edwardsville              KS janders@linkedup.com                              
Mary                      Biers                                              Overland Park             KS mbiers@linkedup.com                               
Linda                     Dualla                                             Mission                   KS ldualla@linkedup.com                              
Helen                     Katriaine                                          Lenexa                    KS hkatriaine@linkedup.com                           
Ken                       Conoy                                              Gardner                   KS kconoy@linkedup.com                               
Carol                     Roslin                                             Leawood                   KS croslin@linkedup.com                              
Lauren                    Thrace                                             Piper                     KS lthrace@linkedup.com                              

7 rows selected. 

SQL> 
SQL> 
SQL> 
SQL> --Q30. Show the first name, last name, and blog_desc for the blogs with the 2nd and 3rd highest hit counts.
SQL> SELECT e.first_name, e.last_name, b.blog_desc, b.hit_count
  2  FROM employees e JOIN websites w 
  3      ON e.employee_id = w.employee_id
  4      JOIN blogs b ON w.blog_id = b.blog_id
  5  ORDER BY b.hit_count DESC
  6  OFFSET 1 ROWS 
  7  FETCH NEXT 2 ROWS ONLY;

FIRST_NAME                LAST_NAME
------------------------- --------------------------------------------------
BLOG_DESC
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HIT_COUNT
----------
Matthew                   Cavil                                              
Matts neat blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
        56

Mary                      Biers                                              
Desktop rollout blog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
        32


